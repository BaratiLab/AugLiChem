<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Molecule | AugLiChem</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Molecule" />
<meta name="author" content="BaratiLab" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="AugLiChem supports data augmentation for organic and inorganic systems. Pre-defined augmentations, built-in data downloading, automatic data cleaning, and pre-implemented models make AugLiChem easy to use." />
<meta property="og:description" content="AugLiChem supports data augmentation for organic and inorganic systems. Pre-defined augmentations, built-in data downloading, automatic data cleaning, and pre-implemented models make AugLiChem easy to use." />
<link rel="canonical" href="http://localhost:4000/molecule.html" />
<meta property="og:url" content="http://localhost:4000/molecule.html" />
<meta property="og:site_name" content="AugLiChem" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Molecule" />
<script type="application/ld+json">
{"url":"http://localhost:4000/molecule.html","headline":"Molecule","author":{"@type":"Person","name":"BaratiLab"},"description":"AugLiChem supports data augmentation for organic and inorganic systems. Pre-defined augmentations, built-in data downloading, automatic data cleaning, and pre-implemented models make AugLiChem easy to use.","@type":"WebPage","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="AugLiChem" /></head>
<body><div class="site-sidebar">

    <a class="sidebar-title" href="/">
    <img src="images/logo.png" alt="drawing" width="20"/>
	    AugLiChem

    <img src="images/Project.png" alt="drawing" width="20"/>
    </a>

    
    
    <!--  -->
    <nav class="site-nav">
      <input type="checkbox" id="nav-trigger" class="nav-trigger" />
      <label for="nav-trigger">
        <span class="menu-icon">
          <svg viewBox="0 0 18 15" width="18px" height="15px">
            <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
            <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
            <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
          </svg>
        </span>
      </label>

      <form class="trigger" method="get" action="/search">
        <input type="text" name="q" placeholder="Search blog">
      </form>

      <ul id="page-list" class="trigger sidebar-list">
        
          
          
        
          
          
            <li class=""><a href="/about.html">About</a></li>
          
        
          
          
            <li class=""><a href="/crystal.html">Crystal</a></li>
          
        
          
          
            <li class=""><a href="/crystal_usage.html">Crystal Usage</a></li>
          
        
          
          
            <li class="active"><a href="/molecule.html">Molecule</a></li>
          
        
          
          
            <li class=""><a href="/molecule_usage.html">Molecule Usage</a></li>
          
        
          
          
            <li class=""><a href="/install_guide.html">Installation</a></li>
          
        
      </ul>
    <!--  -->

      
        <ul id="post-list" class="trigger sidebar-list">
          
            <li class="">
              
              <span>Oct 29, 2021</span><br>
              <a href="/2021/10/29/release.html">Release</a>
            </li>
          
        </ul>
      
    </nav>

</div>
<div class="main-wrapper"><header class="site-header" role="banner">

  <div class="wrapper">
    <a class="site-title" rel="author" href="/">
	    AugLiChem
    </a>
  </div>
</header>
<main class="page-content" aria-label="Content">
        <div class="wrapper">
          <article class="post">

  <header class="post-header">
    <h1 class="post-title">Molecule</h1>
  </header>

  <div class="post-content">
    <p>Molecular augmentation is done at call-time because augmented molecules cannot be stored in the SMILES format.
Graphs are built from the molecule, and augmentations are done on the graphical representation.</p>

<h2 id="graphical-representation-of-molecules">Graphical Representation of Molecules</h2>

<p>Molecules can be very naturally interpreted as graphs.
A finite number of possible atoms are connected by one of a finite set of bond types, and due to their inherent translational and rotational invariance, cartesian coordinates would be difficult to use.
We therefore represent atoms as nodes, with the atom type as the node attribute, and bonds are their connections with bond type being captured by the edge attribute.</p>

<p>In methane, we have a carbon atom surrounded by four hydrogen atoms, seen here.</p>

<p><img src="/images/methane.png" alt="methane" /></p>

<p>The central carbon, labeled atom 0, is connected to each hydrogen, numbered 1 through 4.
Our node attirbute vector, is seen below. Atom number is captured by zero-indexed index in our vector, where the second column is 1 if the atom is a chiral center.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">atom_feature</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>
</code></pre></div></div>

<p>Our edge index captures the bonds between molecules, and goes both ways.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">edge_index</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
</code></pre></div></div>

<p>The last piece of information we have is the edge attribute.
This captures the bond type information, where 0 represents a single bond, and the second columns is 1 if the bond is aromatic.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">edge_attribute</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                 <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                 <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                 <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                 <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                 <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                 <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                 <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
</code></pre></div></div>

<p>With our graph representation, we can use Graph Neural Networks, and can easily augment our data.</p>

<h2 id="data-augmentation">Data Augmentation</h2>

<h3 id="atom-masking">Atom Masking</h3>

<p><img src="/images/Picture1.png" alt="bond_delete" /></p>

<p>Random atom masking replaces randomly selected node attributes with a mask token.
The fraction of atoms masked is passed in as an argument, and at least one atom is masked regardless of the fraction selected.
In the graph representation, the atoms are still there, but masked atoms are all represented by the same token.
This transformation can be imported and initilized as follows:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">auglichem.molecule</span> <span class="kn">import</span> <span class="n">RandomAtomMask</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">RandomAtomMask</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="bond-deletion">Bond Deletion</h3>

<p><img src="/images/Picture2.png" alt="bond_delete" /></p>

<p>Random  bond deletion removes bonds from our graph representation.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">auglichem.molecule</span> <span class="kn">import</span> <span class="n">RandomBondDelete</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">RandomBondDelete</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span></code></pre></figure>

<h3 id="motif-removal">Motif Removal</h3>

<p><img src="/images/motif.png" alt="motif" /></p>

<p>Motif removal is different from the other augmentations in that it is deterministic.
A similarity score is calculated between motifs and the molecule, where motifs above the threshold are retained.
This threshold can be set by passing in an argument.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">auglichem.molecule</span> <span class="kn">import</span> <span class="n">MotifRemoval</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">MotifRemoval</span><span class="p">(</span><span class="mf">0.6</span><span class="p">)</span>
</code></pre></div></div>

<p>For a more detailed guide on using these augmentations, please read the <a href="../usage_guide">usage guide</a>.
In addition to the guide provided here, ready to use notebooks demonstrate both <a href="https://github.com/BaratiLab/AugLiChem/blob/main/examples/molecule_dataset.ipynb">single</a> and <a href="https://github.com/BaratiLab/AugLiChem/blob/main/examples/molecule_multitarget_dataset.ipynb">multitarget</a> training for both regression and classification.</p>

<h2 id="data-sets">Data Sets</h2>

<p>Automatic downloading and cleaning is supported for a number of standard benchmark sets, available from moleculenet.
These benchmarks represent four different biological and physical settings: biophysics, physical chemistry, physiology, and quantum mechanics.
AugLiChem provides support for data sets in each setting:</p>
<ul>
  <li>Biophysics:
    <ul>
      <li>MUV, HIV, PCBA, BACE</li>
    </ul>
  </li>
  <li>Physical Chemistry:
    <ul>
      <li>ESOL, FreeSolv, Lipophilicity</li>
    </ul>
  </li>
  <li>Physiology:
    <ul>
      <li>BBBP, Tox21, ToxCast, SIDER, ClinTox</li>
    </ul>
  </li>
  <li>Quantum Mechanics:
    <ul>
      <li>QM7, QM8, QM9</li>
    </ul>
  </li>
</ul>

<h2 id="models">Models</h2>

<p>In addition to data sets, AugLiChem has popular models implemented and ready to use with our graph data.
<a href="https://pubs.acs.org/doi/10.1021/acs.jmedchem.9b00959">AttentiveFP</a>, <a href="https://arxiv.org/abs/1609.02907">Graph Convolutional Netowrk</a>, <a href="https://arxiv.org/abs/1904.03751">Deep Graph Convolutional Network</a>, and <a href="https://arxiv.org/abs/1905.12265">Modified Graph Isomorphism Network</a> are all supported, and readers are referred to the respective papers for the model details.</p>

  </div>

</article>

        </div>
      </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">AugLiChem</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">BaratiLab</li><li><a class="u-email" href="mailto:your-email@domain.com">your-email@domain.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/BaratiLab"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">BaratiLab</span></a></li><li><a href="https://www.twitter.com/AmirBaratiF"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">AmirBaratiF</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>AugLiChem supports data augmentation for organic and inorganic systems. Pre-defined augmentations, built-in data downloading, automatic data cleaning, and pre-implemented models make AugLiChem easy to use.
</p>
      </div>
    </div>

  </div>

</footer>
</div>

    <script>
      (function() {

        var postList = document.getElementById('post-list');
	      var activePost = postList.getElementsByClassName('active')[0];

        var post = document.getElementsByClassName('post-content')[0];

        var headings = [];

        var tag_names = {
            h1:1,
            h2:1,
            h3:1,
            h4:1,
            h5:1,
            h6:1
        };

        function walk(root) {
            if (root.nodeType === 1 && root.nodeName !== 'script') {
                if (tag_names.hasOwnProperty(root.nodeName.toLowerCase())) {
                    headings.push(root);
                } else {
                    for (var i = 0; i < root.childNodes.length; i++) {
                        walk(root.childNodes[i]);
                    }
                }
            }
        }

        walk(post);

        if (headings.length > 0) {
          var ul = document.createElement("ul");
          ul.classList.add("sidebar-headings")
          activePost.appendChild(ul);

          for (var i=0, max=headings.length; i < max; i++) {
            var li = document.createElement("li");
            li.classList.add("sidebar-" + headings[i].tagName.toLowerCase());
            var a = document.createElement("a");
            var aText = document.createTextNode(headings[i].innerText);
            a.appendChild(aText);
            a.href = "#" + headings[i].id;
            li.appendChild(a);
            ul.appendChild(li);
          }
        }

      })();
    </script>

  </body>

</html>
